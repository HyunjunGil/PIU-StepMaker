# PIU StepMaker-KeyboardEdition

## 1. 소개
Step Edit Lite의 기본 기능 구현 및 키보드만을 사용한 작업이 가능하도록 구현하였습니다.

python의 pygame 패키지를 이용하여 구현하였습니다. 추후에 Electron 프레임워크를 이용하여 웹에서 사용할 수 있도록 구현할 예정입니다.


## 2. 설치 및 사용 방법
python 3.12 버전을 사용하실 것을 권장합니다.

레포지토리를 로컬에 복사한 후 아래 커맨드로 필요한 패키지를 설치합니다

    pip install -r requirements.txt


## 3. 화면 구성 요소 설명
화면은 아래와 같이 구성되어 있으며 각각의 명칭은 아래와 같습니다.


<이미지를 넣을 것!>


그 밖에 사용되는 용어는 아래와 같습니다.

- **조작 영역** : 가장 좌측에 각종 버튼이 있는 영역 입니다.
- **선택된 버튼** : 버튼을 클릭하거나 입력을 위해 텍스트 박스를 선택했을 때 그 버튼
- **차트 영역** : 화면 중앙에 차트가 그려지는 영역 입니다.
- **선택 영역** : 속이 빈 검은 색 사각형으로 표시되는 영역입니다.
- **마디 영역** : 차트 영역 바로 우측에 있는 영역 입니다.
- **스크롤바 영역** :마디 영역 우측에 스크롤바가 그려진 영역입니다.



## 4. 키 가이드

## 4.1 기본 키

| **키/버튼** | **기능**           |
|-------------|--------------------|
| 방향키      | 선택 영역을 상하좌우로 이동합니다.<br>- 상하로 이동할 때 Ctrl을을 누르고 이동할 시 마디 단위로 이동합니다. <br>- Shift를 누르고 이동할 경우 처음의 위치를 기준으로 선택된 영역을 넓힐 수 있습니다. <br>- Alt를 누르고 이동할 경우 노트를 미세조정할 수 있습니다. 자세한 내용은 아래에서 확인할 수 있습니다. |
| z/q/s/e/c/v/r/g/y/n (스텝키) | 차트에 있는 각 10개의 라인에 각각 대응되는 키 입니다. 선택 영역의 각 라인을 그리거나 없앨 수 있습니다. 자세한 동작은 아래에서 확인할 수 있습니다.|
|← (Backspace)|선택된 영역에 걸쳐있는 있는 모든 노트를 지웁니다. **롱노트의 일부라도 선택된 영역에 포함된다면 지워집니다.**|
|Tab| 초점이 맞춰진 버튼이 있다면 다음 버튼으로 초점을 옮깁니다.|
|Esc| 초점이 맞춰진 버튼이 있다면 해제합니다.|
|Enter|초점이 맞춰진 버튼튼이 있다면 그 버튼을 클릭하는 효과를 발동합니다.|
| F1 | Auto Line Pass<링크> 모드를 키거나 끕니다.|
| F5 | 음악을 재생하거나 정지합니다.|
## 4.2 Ctrl 단축키

### 4.2.1 차트영역 조작/편집
| **키/버튼** | **기능**           |
|-------------|--------------------|
|Ctrl + C     |(Copy) 선택된 영역의 차트를 클립보드에 복사합니다. |
|Ctrl + X|(Cut) 선택된 영역의 차트를 클립보드에 복사하고 모두 지웁니다. |
|Ctrl + V|(Paste) **선택된 영역의 차트를 모두 지우고** 클립보드에 있는 차트를 선택된 영역의 시작 라인부터 붙여넣습니다. |
|Ctrl + Z|바로 이전에 했던 행동을 되돌립니다. 되돌릴 수 있는는 행동은 아래와 같습니다 <br> - z/q/s/e/c/v/r/g/y/n 및 backspace <br>- 복사, 잘라내기, 붙여넣기 <br>- 블록 추가/분할/삭제|
|Ctrl + Shift+ Z|바로 이전에 되돌렸던 행동을 되돌립니다|
|Ctrl + S| (Save) 지금까지의 작업을 저장합니다. 만약 지정된 저장 경로가 없다면 설정하도록 한 후 저장합니다.|
|Ctrl + Shift + S|(Save As) 저장 경로를 새롭게 정한 후 지금까지의 작업을 저장합니다.|
|Ctrl + L| (Load) 새로운 ucs파일을 불러옵니다. 만약 불러온 파일과 같은 이름을 가진 mp3파일이 있다면 함께 불러와서 음원으로 사용합니다.|
|Ctrl + Shift + L|(Load mp3) 새로운 mp3 음원파일을 불러옵니다.|
|Ctrl + A|선택된 영역을 현재 블록 전체로 확장합니다. 한 번 더 누르면 차트영역 전체로 확장됩니다.|
|Ctrl + F| 차트영역 전체체에서 오류를 검사하고 오류가 있는 줄을 찾아 해당 줄로 선택 영역을 이동합니다. 만약 없다면 아무 변화도 일어나지 않습니다.|

---
### 4.2.2 블록 조작/편집
| **키/버튼** | **기능**           |
|-------------|--------------------|
|Ctrl + U| (Add ^) 현재 선택된 블록의 위쪽에 마디 1개의 크기를 가진 블록을 추가합니다. 추가된 블록의 정보는 현재 블록과 동일합니다.|
|Ctrl + I| (Add ^) 현재 선택된 블록의 아래쪽에에 마디 1개의 크기를 가진 블록을 추가합니다. 추가된 블록의 정보는 현재 블록과 동일합니다.|
|Ctrl + O| (Split) 현재 선택된 블록을 해당 라인에서 분할합니다. 만약 현재 라인이 현재 블록의 첫 번째 줄이라면 아무일도 일어나지 않습니다.|
|Ctrl + P| (Delete) 현재 선택된 블록을 삭제합니다. 만약 현재 블록이 한 개밖에 남아있지 않다면 아무일도 일어나지 않습니다.|

### 4.2.3 차트영역 확대/축소

| **키/버튼** | **기능**           |
|-------------|--------------------|
|Ctrl + ,| 스텝 차트의 크기를 한 단계 감소시킵니다|
|Ctrl + .| 스텝 차트의 크기를 한 단계 증가시킵니다|
|Ctrl + -| 스텝 차트의 높이를 한 단계 감소시킵니다|
|Ctrl + +| 스텝 차트의 높이를 한 단계 증가시킵니다|


### 4.2.4 버튼 초점 단축키
| **키/버튼** | **기능**           |
|-------------|--------------------|
|Ctrl + 1| "File" 버튼으로 초점 이동|
|Ctrl + 2| BPM을 입력하는 텍스트박스로 초점 이동|
|Ctrl + 3| "Add ^" 버튼으로 초점 이동|
|Ctrl + 4| "F1" 버튼으로 초점 이동|
|Ctrl + 5| "Clear" 버튼으로 초점 이동|

## 5. 모드
### 5.1 Auto Line Pass
한 줄의 키 입력이 끝난 후에 자동으로 선택된 영역이 다음줄로 이동합니다.
- 선택된 영역은 가로 전체, 세로 1줄로 고정됩니다.
- 모든 스텝키 입력이 끝나야만(눌렸던 키가 올라가야만) 다음 줄로 넘어갑니다.
- 롱노트는 입력이 불가능합니다.



## 6. 동작 설명

### 6.1. 스텝키 동작 설명
- 스텝키를 누를 경우 선택된 영역의 첫 번째 줄과 마지막 번 째 줄 사이에 노트를 생성합니다. 만약 선택된 영역이 세로로 한 줄이라면 단노트를, 여러 줄이라면 롱노트를 생성합니다.
- 노트를 생성할 때 그 위치에 단노트 또는 롱노트가 있다면 해당 롱노트 전체를 지웁니다. 
- Alt를 눌렀을 때 **선택된 영역이 1x1 크기이고** 해당 위치에 위치가 있다면 노트의 위치를 조정합니다. Ctrl를 함께 사용하여 마디 단위로 움직일 수 있습니다.
    1. 단노트라면 위치를 조정합니다. 
    2. 롱노트의 머리, 꼬리 부분이라면 롱노트의 길이를 조정합니다. 조정할 때 다른 노트를 넘어갈 수는 없습니다.
    3. 롱노트의 몸통 부분이라면 롱노트의 위치를 조정합니다. 조정할 때 다른 노트를 넘어갈 수는 없습니다.
- 음악을 재생하면서 스텝키를 누르면 채보인식부분에서 노트를 생성할 수 있습니다. 단노트와 롱노트를 선택할 수 있으며, constants.py를 수정하여 롱노트는 비활성화할 수 있습니다. 
![stepkey_desc](https://github.com/user-attachments/assets/ac4c4192-9079-4c52-9606-5098c58d8ff7)



### 6.2. 마우스 동작 설명
- File 버튼을 클릭하여 숨겨져있는 Load, Save 등의 옵션 박스를 보이게 하거나 숨길 수 있습니다.
- 마우스의 테두리를 드래그하여 화면의 크기를 조절할 수 있습니다. 일정 수준 이하로는 줄일 수 없습니다.
- 각각의 버튼을 클릭하여 버튼의 기능을 사용할 수 있습니다.
- 스크롤바를 드래그하여 채보 위치를 조절할 수 있습니다.
- 채보 인식부분을 드래그하여 위치를 조절할 수 있습니다.
- 채보 영역을 클릭후 드래그 하여 선택 영역을 조절할 수 있습니다.
- 마디 영역을 클릭하면 선택 영역을 해당 마디와 일치시킬 수 있습니다.
<br>![mouse_desc](https://github.com/user-attachments/assets/52b94c24-5bc0-49e6-94ba-bd23d1adc05d)

### 6.3. 편의 기능 키 설명
- Ctrl + F를 통해 에러가 있는 줄을 찾을 수 있습니다. 에러가 없으면 에러가 없다고 로그에 문구를 출력합니다.
- Ctrl + A를 통해 선택 영역을 해당 블록, 전체 영역으로 확장할 수 있습니다.
<br>![util_etc](https://github.com/user-attachments/assets/00ba5a38-f2d7-4de5-bd5c-5d778bdb3968)

## 7. constants.py
constants.py에 있는 값을 수정하여 본인에게 좀 더 맞는 환경을 세팅할 수 있습니다. 자세한 설명은 constants.py의 주석에서 확인할 수 있습니다.

